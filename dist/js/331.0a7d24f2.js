"use strict";(self["webpackChunkexamen_front"]=self["webpackChunkexamen_front"]||[]).push([[331],{331:function(a,t,o){o.r(t),o.d(t,{default:function(){return K}});var s=o(252);const e={class:"mascotas"};function r(a,t,o,r,c,n){const i=(0,s.up)("lista-mascotas");return(0,s.wg)(),(0,s.iD)("div",e,[(0,s.Wm)(i)])}var c=o(963),n=o(577);const i={class:"container"},l=(0,s._)("button",{class:"btn btn-success col-2 offset-5"},"+",-1),d=[l],m={class:"row border rounded mt-4 mb-4 p-2"},p={class:"row"},u=(0,s._)("label",null,"Nombre",-1),h={class:"row"},b=(0,s._)("label",null,"DescripciÃ³n",-1),g=(0,s._)("div",{class:"row mt-2 mb-2"},null,-1),_={class:"row overflow-hidden d-flex justify-content-center"},f={class:"col-3"},w={class:"col-3"},y={class:"row d-flex"},v={class:"card"},k=(0,s._)("img",{src:"#",class:"card-img-top img-mascota",alt:"img mascota"},null,-1),C={key:0},M={class:"card-body"},x=(0,s._)("input",{class:"form-control m-2",type:"file"},null,-1),S={class:"card-title"},$=["onUpdate:modelValue"],N={class:"card-text"},U=["onUpdate:modelValue"],j={class:"card-text"},E=["onClick"],D=["onClick"],O={key:1},F={class:"card-body"},J={class:"card-title"},V={class:"card-text"},z={class:"card-text"},I=["onClick"],T=["onClick"];function L(a,t,o,e,r,l){return(0,s.wg)(),(0,s.iD)("div",i,[(0,s.wy)((0,s._)("div",{class:"row overflow-hidden",onClick:t[0]||(t[0]=(...a)=>l.crearNueva&&l.crearNueva(...a))},d,512),[[c.F8,r.registrado&&!r.nueva]]),(0,s.wy)((0,s._)("div",m,[(0,s._)("form",null,[(0,s._)("div",p,[u,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>r.nombre=a)},null,512),[[c.nr,r.nombre]])]),(0,s._)("div",h,[b,(0,s.wy)((0,s._)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=a=>r.descp=a)},null,512),[[c.nr,r.descp]])]),g,(0,s._)("div",_,[(0,s._)("div",f,[(0,s._)("button",{class:"btn btn-secondary",onClick:t[3]||(t[3]=(...a)=>l.finCrearMascota&&l.finCrearMascota(...a))},"Cancelar")]),(0,s._)("div",w,[(0,s._)("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=(...a)=>l.agregarMascota&&l.agregarMascota(...a))},"Agregar")])])])],512),[[c.F8,r.nueva]]),(0,s._)("div",y,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.mascotas,(a=>((0,s.wg)(),(0,s.iD)("div",{class:"mt-2 col-sm-12 col-md-6 col-xl-4",key:a._id},[(0,s._)("div",v,[k,r.editando===a._id?((0,s.wg)(),(0,s.iD)("div",C,[(0,s._)("div",M,[x,(0,s._)("h5",S,[(0,s.wy)((0,s._)("input",{type:"text",class:"col","onUpdate:modelValue":t=>a.nombre=t},null,8,$),[[c.nr,a.nombre]])]),(0,s._)("h5",N,[(0,s.wy)((0,s._)("input",{type:"text",class:"col","onUpdate:modelValue":t=>a.descripcion=t},null,8,U),[[c.nr,a.descripcion]])]),(0,s.wy)((0,s._)("div",j,[(0,s._)("button",{class:"btn btn-primary m-4 col-4",onClick:t=>l.editarMascota(a)},"Guardar",8,E),(0,s._)("button",{class:"btn btn-secondary m-4 col-4",onClick:t=>l.finEditar(a)},"Cancelar",8,D)],512),[[c.F8,"pasas"==r.registrado]])])])):((0,s.wg)(),(0,s.iD)("div",O,[(0,s._)("div",F,[(0,s._)("h5",J,(0,n.zw)(a.nombre),1),(0,s._)("p",V,(0,n.zw)(a.descripcion),1),(0,s.wy)((0,s._)("div",z,[(0,s._)("button",{class:"btn btn-primary m-4 col-4",onClick:t=>l.iniciarEdicion(a)},"Editar",8,I),(0,s._)("button",{class:"btn btn-danger m-4 col-4",onClick:t=>l.borrarMascota(a)},"Eliminar",8,T)],512),[[c.F8,"pasas"==r.registrado]])])]))])])))),128))])])}var A={name:"ListaMascotas",data(){return{mascotas:[],registrado:"",nueva:!1,nombre:"",descp:"",editando:null,nombre_foto:"",datos:""}},methods:{crearNueva(){this.nueva=!0},finCrearMascota(){this.nueva=!1,this.nombre="",this.descp=""},async obtenerMascotas(){let a=await fetch("https://api-mascotas-jorge.herokuapp.com/api/mascotas",{method:"GET"}),t=await a.json();this.mascotas=t.mascotas},async agregarMascota(){try{let a=localStorage.getItem("mascotas"),t=JSON.parse(a).token;if(!t)throw"no token";await fetch("https://api-mascotas-jorge.herokuapp.com/api/mascotas",{method:"POST",headers:{authorization:`Bearer ${t}`,"Content-type":"application/json; charset=UTF-8"},body:JSON.stringify({nombre:`${this.nombre}`,desc:`${this.descp}`})}),this.finCrearMascota(),this.obtenerMascotas()}catch(a){console.log(a)}},iniciarEdicion(a){this.editando=a._id},async editarMascota(a){try{let t=localStorage.getItem("mascotas"),o=JSON.parse(t).token;if(!o)throw"no token";let s=await fetch(`https://api-mascotas-jorge.herokuapp.com/api/mascotas/${a._id}`,{method:"PUT",body:JSON.stringify({nombre:`${a.nombre}`,desc:`${a.descripcion}`}),headers:{authorization:`bearer ${o}`,"Content-type":"application/json; charset=UTF-8"}});if(200!=s.status)throw"error al editar";this.editando=null,this.obtenerMascotas()}catch(t){console.log(t)}},finEditar(a){this.editando=null,this.obtenerMascotas()},async borrarMascota(a){try{let t=localStorage.getItem("mascotas"),o=JSON.parse(t).token;if(!o)throw"no token";let s=await fetch(`https://api-mascotas-jorge.herokuapp.com/api/mascotas/${a._id}`,{method:"DELETE",headers:{authorization:`bearer ${o}`}});if(200!=s.status)throw"error al borrar";this.obtenerMascotas()}catch(t){console.log("borrar error "+t)}},async estadoUser(){let a=localStorage.getItem("mascotas");a&&(a=await JSON.parse(a),this.registrado=a.rolAct)},async subirImagen(){console.log("enviamos"),console.log(this.$refs.foto_mascota.value);let a=localStorage.getItem("mascotas"),t=JSON.parse(a).token;const o=new FormData;let s=this.$refs.foto_mascota.files[0];o.append("foto_subir",s),console.log("foto_subir ",s);try{let a=await fetch("https://api-mascotas-jorge.herokuapp.com/api/upload",{method:"post",body:o,headers:{authorization:`bearer ${t}`}});a=await a.json(),this.nombre_foto=a.name,console.log(this.nombre_foto)}catch(e){console.log(e)}}},mounted(){this.obtenerMascotas(),this.estadoUser()}},G=o(744);const P=(0,G.Z)(A,[["render",L]]);var Z=P,B={name:"MascotasView",components:{ListaMascotas:Z}};const H=(0,G.Z)(B,[["render",r]]);var K=H}}]);
//# sourceMappingURL=331.0a7d24f2.js.map